<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil de Usuario - Sistema Tributario</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        .profile-picture {
            transition: all 0.3s ease;
            border-color: #3b82f6;
        }
        .profile-picture:hover {
            transform: scale(1.03);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .form-section {
            transition: all 0.3s ease;
        }
        .form-section:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .toast {
            animation: slideIn 0.5s forwards, fadeOut 0.5s 2.5s forwards;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        .nav-link {
            position: relative;
        }
        .nav-link:after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: #3b82f6;
            transition: width 0.3s ease;
        }
        .nav-link:hover:after {
            width: 100%;
        }
        .custom-radio input[type="radio"] {
            display: none;
        }
        .custom-radio input[type="radio"] + label {
            padding-left: 28px;
            position: relative;
            cursor: pointer;
        }
        .custom-radio input[type="radio"] + label:before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        .custom-radio input[type="radio"]:checked + label:before {
            border-color: #3b82f6;
            background-color: #3b82f6;
            box-shadow: inset 0 0 0 4px white;
        }
        #upload {
            display: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-md">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="index.html" class="flex items-center">
                <img src="../IMG/logo.svg" alt="Logo" class="h-10">
                <span class="ml-2 text-xl font-bold text-blue-800">TributApp</span>
            </a>
            <nav class="hidden md:flex space-x-8">
                <a href="Inicio.html" class="nav-link text-gray-700 hover:text-blue-600 font-medium transition-colors duration-300">
                    <i class="fas fa-calendar-alt mr-2"></i>Calendario
                </a>
                <a href="Calculadora.html" class="nav-link text-gray-700 hover:text-blue-600 font-medium transition-colors duration-300">
                    <i class="fas fa-calculator mr-2"></i>Calculadora
                </a>
                <a href="afinarPerfil.html#ejecutar" class="nav-link text-blue-600 font-medium transition-colors duration-300">
                    <i class="fas fa-user mr-2"></i>Perfil
                </a>
            </nav>
            <button class="md:hidden text-blue-600" id="mobile-menu-button">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </div>
        <!-- Mobile menu -->
        <div class="md:hidden hidden bg-white shadow-lg rounded-b-lg" id="mobile-menu">
            <div class="px-4 py-3 flex flex-col space-y-3">
                <a href="Inicio.html" class="text-gray-700 hover:text-blue-600 font-medium">
                    <i class="fas fa-calendar-alt mr-2"></i>Calendario
                </a>
                <a href="Calculadora.html" class="text-gray-700 hover:text-blue-600 font-medium">
                    <i class="fas fa-calculator mr-2"></i>Calculadora
                </a>
                <a href="afinarPerfil.html#ejecutar" class="text-blue-600 font-medium">
                    <i class="fas fa-user mr-2"></i>Perfil
                </a>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- User Profile Section -->
        <section class="bg-white rounded-xl shadow-lg overflow-hidden mb-8">
            <div class="md:flex">
                <!-- Profile Picture Section -->
                <div class="md:w-1/3 p-8 flex flex-col items-center border-b md:border-b-0 md:border-r border-gray-200">
                    <div class="relative group">
                        <img id="preview" src="../Pagina web/imagens/OIP.jpg" alt="Foto de perfil" 
                             class="w-40 h-40 rounded-full object-cover border-4 border-blue-100 profile-picture cursor-pointer">
                        <div class="absolute inset-0 bg-black bg-opacity-30 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                            <span class="text-white font-medium"><i class="fas fa-camera mr-1"></i> Cambiar</span>
                        </div>
                    </div>
                    <input type="file" id="upload" accept="image/*">
                    <div class="mt-6 w-full space-y-4">
                        <div class="relative">
                            <input type="text" id="nombres" placeholder="Nombre y Apellido" disabled
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100">
                        </div>
                        <div class="relative">
                            <input type="text" id="telefono" placeholder="Número de teléfono" disabled
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100">
                        </div>
                        <button type="button" id="cambiarDatos" onclick="modCampos()"
                                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-300 flex items-center justify-center">
                            <span id="buttonText">Cambiar datos</span>
                            <i class="fas fa-pencil-alt ml-2"></i>
                        </button>
                    </div>
                </div>

                <!-- Tax Information Section -->
                <div class="md:w-2/3 p-8">
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">Servicio de asignación de impuestos</h1>
                    <p class="text-gray-600 mb-6">Complete los siguientes datos para calcular sus obligaciones tributarias y acceder a servicios personalizados.</p>

                    <!-- Form Sections -->
                    <div class="space-y-6">
                        <!-- Common Questions -->
                        <div id="ajustesCuadro" class="form-section bg-gray-50 p-6 rounded-lg border border-blue-200 primeraVista">
                            <h2 class="text-xl font-semibold text-blue-800 mb-4 flex items-center">
                                <i class="fas fa-info-circle mr-2"></i> Información básica
                            </h2>
                            <form class="space-y-4">
                                <div>
                                    <label for="encontrate" class="block text-sm font-medium text-gray-700 mb-1">Situación laboral</label>
                                    <select class="select w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" id="encontrate">
                                        <option value="Autonomo">Autónomo</option>
                                        <option value="Asalariado">Asalariado</option>
                                        <option value="Estudiante">Estudiante</option>
                                        <option value="Empresario" selected>Empresario</option>
                                        <option value="Jubilado">Jubilado</option>
                                    </select>
                                </div>

                                <div>
                                    <label for="ingresoBruto" class="block text-sm font-medium text-gray-700 mb-1">Ingreso bruto anual</label>
                                    <div class="relative">
                                        <input type="text" id="ingresoBruto" placeholder="Ej: 35000" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <div>
                                    <label for="edad" class="block text-sm font-medium text-gray-700 mb-1">Edad</label>
                                    <input type="text" id="edad" placeholder="Ej: 34" required
                                           class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>

                                <div>
                                    <label for="personasACargo" class="block text-sm font-medium text-gray-700 mb-1">Personas a tu cargo</label>
                                    <input type="text" id="personasACargo" placeholder="Número de personas" required
                                           class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>

                                <div>
                                    <p class="text-sm font-medium text-gray-700 mb-2">¿Tienes más de una vivienda en propiedad?</p>
                                    <div id="radio-group" class="flex space-x-6">
                                        <div class="custom-radio">
                                            <input type="radio" id="viviendaSi" name="vivienda" value="si">
                                            <label for="viviendaSi" class="text-gray-700">Sí</label>
                                        </div>
                                        <div class="custom-radio">
                                            <input type="radio" id="viviendaNo" name="vivienda" value="no">
                                            <label for="viviendaNo" class="text-gray-700">No</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="pt-4 text-center text-sm text-blue-800 font-medium">
                                    <p>1 de 2</p>
                                </div>
                            </form>
                        </div>

                        <!-- Autonomo Section -->
                        <div id="ajustesCuadroAutonomo" class="form-section bg-gray-50 p-6 rounded-lg border border-blue-200 hidden">
                            <h2 class="text-xl font-semibold text-blue-800 mb-4 flex items-center">
                                <i class="fas fa-user-tie mr-2"></i> Detalles de Autónomo
                            </h2>
                            <form class="space-y-4">
                                <div>
                                    <label for="datetime" class="block text-sm font-medium text-gray-700 mb-1">Fecha de alta como autónomo</label>
                                    <input type="datetime-local" name="datetime" id="datetime"
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>

                                <div>
                                    <label for="actividadProfesional" class="block text-sm font-medium text-gray-700 mb-1">Profesión/Código CNAE</label>
                                    <input type="number" id="actividadProfesional" placeholder="Ej: 6201" required
                                           class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>

                                <div>
                                    <label for="gastosDeducibles" class="block text-sm font-medium text-gray-700 mb-1">Gastos deducibles anuales</label>
                                    <div class="relative">
                                        <input type="number" id="gastosDeducibles" placeholder="Ej: 5000" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <div>
                                    <label for="ivaSoportado" class="block text-sm font-medium text-gray-700 mb-1">IVA soportado</label>
                                    <div class="relative">
                                        <input type="number" id="ivaSoportado" placeholder="Ej: 1200" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <div>
                                    <label for="ivaRepercutido" class="block text-sm font-medium text-gray-700 mb-1">IVA repercutido</label>
                                    <div class="relative">
                                        <input type="number" id="ivaRepercutido" placeholder="Ej: 1800" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <div>
                                    <p class="text-sm font-medium text-gray-700 mb-2">¿Utilizas vehículo para tu actividad?</p>
                                    <div id="radio-group" class="flex space-x-6">
                                        <div class="custom-radio">
                                            <input type="radio" id="vehiculoSi" name="vehiculo" value="si">
                                            <label for="vehiculoSi" class="text-gray-700">Sí</label>
                                        </div>
                                        <div class="custom-radio">
                                            <input type="radio" id="vehiculoNo" name="vehiculo" value="no">
                                            <label for="vehiculoNo" class="text-gray-700">No</label>
                                        </div>
                                    </div>
                                </div>

                                <button class="boton w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-300 mt-4" 
                                        type="button" onclick="enviarCuestionario()">
                                    Enviar cuestionario <i class="fas fa-paper-plane ml-2"></i>
                                </button>
                            </form>
                        </div>

                        <!-- Asalariado Section -->
                        <div id="ajustesCuadroAsalariado" class="form-section bg-gray-50 p-6 rounded-lg border border-blue-200 hidden">
                            <h2 class="text-xl font-semibold text-blue-800 mb-4 flex items-center">
                                <i class="fas fa-briefcase mr-2"></i> Detalles de Asalariado
                            </h2>
                            <form class="space-y-4">
                                <div>
                                    <label for="tipoContrato" class="block text-sm font-medium text-gray-700 mb-1">Tipo de contrato</label>
                                    <select class="select w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" id="tipoContrato">
                                        <option value="indefinido">Indefinido</option>
                                        <option value="temporal">Temporal</option>
                                        <option value="parcial">Jornada Parcial</option>
                                    </select>
                                </div>

                                <div>
                                    <p class="text-sm font-medium text-gray-700 mb-2">¿Tienes título de familia numerosa?</p>
                                    <div id="radio-group" class="flex space-x-6">
                                        <div class="custom-radio">
                                            <input type="radio" id="familiaNumerosaSi" name="familiaNumerosa" value="si">
                                            <label for="familiaNumerosaSi" class="text-gray-700">Sí</label>
                                        </div>
                                        <div class="custom-radio">
                                            <input type="radio" id="familiaNumerosaNo" name="familiaNumerosa" value="no">
                                            <label for="familiaNumerosaNo" class="text-gray-700">No</label>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label for="edadesHijos" class="block text-sm font-medium text-gray-700 mb-1">Edades de tus hijos (separadas por comas)</label>
                                    <input type="text" id="edadesHijos" placeholder="Ej: 4, 8, 16" required
                                           class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>

                                <div>
                                    <label for="gastosEscolares" class="block text-sm font-medium text-gray-700 mb-1">Gastos escolares/educativos anuales</label>
                                    <div class="relative">
                                        <input type="number" id="gastosEscolares" placeholder="Ej: 2500" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <button class="boton w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-300 mt-4" 
                                        type="button" onclick="enviarCuestionario()">
                                    Enviar cuestionario <i class="fas fa-paper-plane ml-2"></i>
                                </button>
                            </form>
                        </div>

                        <!-- Estudiante Section -->
                        <div id="ajustesCuadroEstudiante" class="form-section bg-gray-50 p-6 rounded-lg border border-blue-200 hidden">
                            <h2 class="text-xl font-semibold text-blue-800 mb-4 flex items-center">
                                <i class="fas fa-graduation-cap mr-2"></i> Detalles de Estudiante
                            </h2>
                            <form class="space-y-4">
                                <div>
                                    <label for="tipoEstudios" class="block text-sm font-medium text-gray-700 mb-1">Tipo de estudios</label>
                                    <select class="select w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" id="tipoEstudios">
                                        <option value="universidad">Universidad</option>
                                        <option value="fp">Formación Profesional</option>
                                        <option value="otro">Otro</option>
                                    </select>
                                </div>

                                <div>
                                    <p class="text-sm font-medium text-gray-700 mb-2">¿Trabajas a tiempo parcial?</p>
                                    <div id="radio-group" class="flex space-x-6">
                                        <div class="custom-radio">
                                            <input type="radio" id="trabajoSi" name="trabajoParcial" value="si">
                                            <label for="trabajoSi" class="text-gray-700">Sí</label>
                                        </div>
                                        <div class="custom-radio">
                                            <input type="radio" id="trabajoNo" name="trabajoParcial" value="no">
                                            <label for="trabajoNo" class="text-gray-700">No</label>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label for="becaCantidad" class="block text-sm font-medium text-gray-700 mb-1">Beca recibida (anual)</label>
                                    <div class="relative">
                                        <input type="number" id="becaCantidad" placeholder="Ej: 3000" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <button class="boton w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-300 mt-4" 
                                        type="button" onclick="enviarCuestionario()">
                                    Enviar cuestionario <i class="fas fa-paper-plane ml-2"></i>
                                </button>
                            </form>
                        </div>

                        <!-- Jubilado Section -->
                        <div id="ajustesCuadroJubilado" class="form-section bg-gray-50 p-6 rounded-lg border border-blue-200 hidden">
                            <h2 class="text-xl font-semibold text-blue-800 mb-4 flex items-center">
                                <i class="fas fa-umbrella-beach mr-2"></i> Detalles de Jubilado
                            </h2>
                            <form class="space-y-4">
                                <div>
                                    <label for="pensionAnual" class="block text-sm font-medium text-gray-700 mb-1">Pensión anual</label>
                                    <div class="relative">
                                        <input type="number" id="pensionAnual" placeholder="Ej: 18000" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <div>
                                    <p class="text-sm font-medium text-gray-700 mb-2">¿Tienes segunda vivienda no alquilada?</p>
                                    <div id="radio-group" class="flex space-x-6">
                                        <div class="custom-radio">
                                            <input type="radio" id="segundaViviendaSi" name="segundaVivienda" value="si">
                                            <label for="segundaViviendaSi" class="text-gray-700">Sí</label>
                                        </div>
                                        <div class="custom-radio">
                                            <input type="radio" id="segundaViviendaNo" name="segundaVivienda" value="no">
                                            <label for="segundaViviendaNo" class="text-gray-700">No</label>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label for="gastosMedicos" class="block text-sm font-medium text-gray-700 mb-1">Gastos médicos anuales</label>
                                    <div class="relative">
                                        <input type="number" id="gastosMedicos" placeholder="Ej: 800" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <button class="boton w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-300 mt-4" 
                                        type="button" onclick="enviarCuestionario()">
                                    Enviar cuestionario <i class="fas fa-paper-plane ml-2"></i>
                                </button>
                            </form>
                        </div>

                        <!-- Empresario Section -->
                        <div id="ajustesCuadroEmpresario" class="form-section bg-gray-50 p-6 rounded-lg border border-blue-200 hidden">
                            <h2 class="text-xl font-semibold text-blue-800 mb-4 flex items-center">
                                <i class="fas fa-building mr-2"></i> Detalles de Empresario
                            </h2>
                            <form class="space-y-4">
                                <div>
                                    <label for="tipoContratoEmpresario" class="block text-sm font-medium text-gray-700 mb-1">Tipo de sociedad</label>
                                    <select class="select w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" id="tipoContrato">
                                        <option value="indefinido">Sociedad Limitada</option>
                                        <option value="temporal">Sociedad Anónima</option>
                                        <option value="parcial">Autónomo Societario</option>
                                    </select>
                                </div>

                                <div>
                                    <label for="facturacionEmpresa" class="block text-sm font-medium text-gray-700 mb-1">Facturación anual</label>
                                    <div class="relative">
                                        <input type="number" id="facturacionEmpresa" placeholder="Ej: 120000" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <div>
                                    <label for="sueldoAdministrador" class="block text-sm font-medium text-gray-700 mb-1">Sueldo como administrador</label>
                                    <div class="relative">
                                        <input type="number" id="sueldoAdministrador" placeholder="Ej: 30000" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <div>
                                    <label for="empleados" class="block text-sm font-medium text-gray-700 mb-1">Número de empleados</label>
                                    <input type="number" id="empleados" placeholder="Ej: 5" required
                                           class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>

                                <div>
                                    <label for="gastosDeduciblesEmpresa" class="block text-sm font-medium text-gray-700 mb-1">Gastos deducibles anuales</label>
                                    <div class="relative">
                                        <input type="number" id="gastosDeduciblesEmpresa" placeholder="Ej: 35000" required
                                               class="line w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <span class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500">€</span>
                                    </div>
                                </div>

                                <button class="boton w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-300 mt-4" 
                                        type="button" onclick="enviarCuestionario()">
                                    Enviar cuestionario <i class="fas fa-paper-plane ml-2"></i>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Action Buttons -->
        <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0 md:space-x-4">
            <button id="reiniciarForm" class="w-full md:w-auto bg-gray-600 hover:bg-gray-700 text-white font-medium py-3 px-6 rounded-lg transition-colors duration-300" 
                    type="button" onclick="reiniciarCuestionario()">
                <i class="fas fa-redo mr-2"></i> Reiniciar cuestionario
            </button>
            
            <div id="botones" class="flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto">
                <button id="cerrarSesion" class="w-full bg-red-600 hover:bg-red-700 text-white font-medium py-3 px-6 rounded-lg transition-colors duration-300" 
                        type="button">
                    <i class="fas fa-sign-out-alt mr-2"></i> Cerrar sesión
                </button>
                <a href="recogerEmail.html" class="w-full text-center bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-6 rounded-lg transition-colors duration-300">
                    <i class="fas fa-key mr-2"></i> Cambiar contraseña
                </a>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-300 py-8">
        <div class="container mx-auto px-4">
            <div class="md:flex md:justify-between md:items-center">
                <div class="mb-6 md:mb-0">
                    <h3 class="text-xl font-bold text-white mb-2">TributApp</h3>
                    <p class="max-w-md">Tu solución integral para la gestión tributaria personal y empresarial.</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div>
                        <h4 class="text-lg font-semibold text-white mb-4">Contacto</h4>
                        <ul class="space-y-2">
                            <li class="flex items-center"><i class="fas fa-phone-alt mr-2 text-blue-400"></i> 123-456-7890</li>
                            <li class="flex items-center"><i class="fas fa-envelope mr-2 text-blue-400"></i> info@tributapp.com</li>
                            <li class="flex items-center"><i class="fas fa-map-marker-alt mr-2 text-blue-400"></i> Calle Principal, 123, Ciudad Financiera</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-semibold text-white mb-4">Legal</h4>
                        <ul class="space-y-2">
                            <li><a href="#" class="hover:text-blue-400">Términos de servicio</a></li>
                            <li><a href="#" class="hover:text-blue-400">Política de privacidad</a></li>
                            <li><a href="#" class="hover:text-blue-400">Aviso legal</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-semibold text-white mb-4">Síguenos</h4>
                        <div class="flex space-x-4">
                            <a href="#" class="text-blue-400 hover:text-blue-300 text-xl"><i class="fab fa-facebook"></i></a>
                            <a href="#" class="text-blue-400 hover:text-blue-300 text-xl"><i class="fab fa-twitter"></i></a>
                            <a href="#" class="text-blue-400 hover:text-blue-300 text-xl"><i class="fab fa-linkedin"></i></a>
                            <a href="#" class="text-blue-400 hover:text-blue-300 text-xl"><i class="fab fa-instagram"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-sm">
                <p>&copy; 2023 TributApp. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Toast Notifications -->
    <div id="toasts" class="fixed bottom-4 right-4 space-y-2 z-50"></div>

    <!-- JavaScript -->
    <script>
       async function cargarDatosUsuario() {
  await new Promise(resolve => setTimeout(resolve, 300))
  if (
    typeof window.transferenciaDeDatos.recibirDatos === "function" &&
    typeof window.transferenciaDeDatos.recibirDatosPerfil === "function"
  ) {
    const datosPerfil = await window.transferenciaDeDatos.recibirDatosPerfil();
    console.log("Perfil del usuario:", datosPerfil);
    rellenarDatosPerfil(datosPerfil);

    const datosUsuario = await window.transferenciaDeDatos.recibirDatos();
    console.log("Datos del usuario:", datosUsuario);
    rellenarDatosUsuario(datosUsuario);
  } else {
    console.error("recibirDatos o recibirDatosPerfil no están definidos.");
  }
  console.log("Script JavaScript iniciado!");
}

window.onload = cargarDatosUsuario;




function mostrarCuadro(idCuadroActivo) {
  const cuadros = document.querySelectorAll(".ajustes-cuadro");
  cuadros.forEach(cuadro => {
    cuadro.classList.remove("activo");
  });

  const cuadroActivo = document.getElementById(idCuadroActivo);
  if (cuadroActivo) {
    cuadroActivo.classList.add("activo");
  }
}

function segundaFase() {
  const encontrate = document.getElementById("encontrate").value;
  mostrarCuadro("ajustesCuadro" + encontrate);
}


const combo = document.getElementById('encontrate');
combo.addEventListener('change', (event) => {
  const valorSeleccionado = event.target.value;
  mostrarCuadro("ajustesCuadro" + valorSeleccionado);
});


let activo = false
function modCampos() {
  console.log("modCampos ejecutado");
  let perfilDatos = [];
  const nombre = document.querySelector("#nombres");
  const telefono = document.querySelector("#telefono");
  const button = document.querySelector("#cambiarDatos");

  perfilDatos.push({
    nombre: nombre.value,
    telefono: telefono.value,
  });
  console.log(nombre.value)
  console.log(telefono.value)

  console.log("ejecuta")
  if (window.transferenciaDeDatos && typeof window.transferenciaDeDatos.enviarPerfil === "function") {
    window.transferenciaDeDatos.enviarPerfil(perfilDatos);
  } else {
    console.error("enviarPerfil no está definido como función en transferenciaDeDatos");
  }

  if (!activo) {
    button.style.backgroundColor = "green";
    activo = true;
    nombre.disabled = false;
    telefono.disabled = false;
    button.textContent = "guardar cambios";
  } else {
    button.style.backgroundColor = "blue";
    activo = false;
    nombre.disabled = true;
    telefono.disabled = true;
    button.innerHTML = `
    Cambiar datos 
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16">
    <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325"/>
    </svg>
    `;
  }
}
function rellenarDatosPerfil(datosPerfil) {
  console.log("paso 1.1")
  const nombre = document.querySelector("#nombres");
  const telefono = document.querySelector("#telefono");
  console.log(datosPerfil)
  if (datosPerfil) {
    console.log("paso 1.2")//no entra
    nombre.value = datosPerfil.nombre;
    telefono.value = datosPerfil.telefono;
  }
}

function rellenarDatosUsuario(datosPerfilar) {
  console.log("paso 1.3")
  console.log(datosPerfilar)
  console.log("--------------------------entra---------------------------")

  // Rellenar preguntas comunes
  const datosComunes = datosPerfilar;
  console.log("Rellenando preguntas comunes:", datosComunes);
  comboSituacionBasic.value = datosComunes.eleecion;
  lineIngresoBasic.value = datosComunes.ingresoBruto;
  lineEdadBasic.value = datosComunes.edad;
  lineAcargoBasic.value = datosComunes.personasACargo;
  if (typeof datosComunes.vivienda === "boolean") {
    radioViviendaTrueBasic.checked = datosComunes.vivienda === true;
    radioViviendaFalseBasic.checked = datosComunes.vivienda === false;
  }

  // Mostrar el cuadro adecuado según la situación
  console.log("Mostrando cuadro para:", datosComunes.eleecion);
  mostrarCuadro("ajustesCuadro" + (datosComunes.eleecion));

  // Rellenar preguntas específicas según el tipo
  const tipo = datosComunes.eleecion;
  const datosEspecificos = datosPerfilar;
  console.log("Tipo de usuario:", tipo, "Datos específicos:", datosEspecificos);

  if (tipo === "Autonomo") {
    console.log("Rellenando campos de Autónomo");
    dateAltaAutonomo.value = datosEspecificos.fechaAlta;
    lineActividadAutonomo.value = datosEspecificos.actividad;
    lineGastosAutonomo.value = datosEspecificos.gastosDeducibles;
    lineIvaSuportAutonomo.value = datosEspecificos.ivaSoportado;
    lineIvaRepertAutonomo.value = datosEspecificos.ivaRepercutido;
    if (typeof datosEspecificos.vehiculo === "boolean") {
      radiovehiculoTrueAutonomo.checked = datosEspecificos.vehiculo === true;
      radiovehiculoFalseAutonomo.checked = datosEspecificos.vehiculo === false;
    }
  } else if (tipo === "Asalariado") {
    console.log("Rellenando campos de Asalariado");
    comboTipoJobAsalariado.value = datosEspecificos.tipoContrato;
    if (typeof datosEspecificos.familiaNumerosa === "boolean") {
      radioFamiliaTrueAsalariado.checked = datosEspecificos.familiaNumerosa === true;
      radioFamiliaFalseAsalariado.checked = datosEspecificos.familiaNumerosa === false;
    }
    lineArrayEdadesAsalariado.value = datosEspecificos.edadesHijos;
    lineGastosAsalariado.value = datosEspecificos.gastosEscolares;
  } else if (tipo === "Estudiante") {
    console.log("Rellenando campos de Estudiante");
    comboEstudiosEstudiante.value = datosEspecificos.tipoEstudios; //falaaaaaaaaalalllaaaaaaaaaaa
    if (typeof datosEspecificos.trabaja === "boolean") {
      radioTrabajoTrueEstudiante.checked = datosEspecificos.trabaja === true;
      radioTrabajoFalseEstudiante.checked = datosEspecificos.trabaja === false;
    }
    lineBecaEstudiante.value = datosEspecificos.becaCantidad;
  } else if (tipo === "Jubilado") {
    console.log("Rellenando campos de Jubilado");
    linePensionJubilado.value = datosEspecificos.pensionAnual;
    if (typeof datosEspecificos.segundaVivienda === "boolean") {
      radioSegundaViviendaTrueJubilado.checked = datosEspecificos.segundaVivienda === true;
      radioSegundaViviendaFalseJubilado.checked = datosEspecificos.segundaVivienda === false;
    }
    lineGastosMedicosJubilado.value = datosEspecificos.gastosMedicos;
  } else if (tipo === "Empresario") {
    console.log("Rellenando campos de Empresario");
    comboTipoContratoEmpresario.value = datosEspecificos.tipoContrato;
    lineFacturacionEmpresario.value = datosEspecificos.facturacionEmpresa;
    lineSueldoAdministradorEmpresario.value = datosEspecificos.sueldoAdministrador;
    lineEmpleadosEmpresario.value = datosEspecificos.empleados;
    lineGastosDeduciblesEmpresario.value = datosEspecificos.gastosDeduciblesEmpresa;
  }

  // Deshabilitar todos los campos del formulario
  deshabilitarCampos();
}


function enviarCuestionario() {
  let datos = [];


  if (!lineIngresoBasic.value || !lineEdadBasic.value || !lineAcargoBasic.value || (!radioViviendaTrueBasic.checked && !radioViviendaFalseBasic.checked)) {
    mostrarToast("Faltan preguntas comunes por completar", "error");
    return;
  }



  const eleecion = comboSituacionBasic.value;
  /* const ingresoBruto = lineIngresoBasic.value;
   const edad = lineEdadBasic.value;
   const personasACargo = lineAcasgoBasic.value;
   const vivienda = radioViviendaTrueBasic.checked ? true : false;*/

  datos.push({
    eleecion: comboSituacionBasic.value,
    ingresoBruto: lineIngresoBasic.value,
    edad: lineEdadBasic.value,
    personasACargo: lineAcargoBasic.value,
    vivienda: radioViviendaTrueBasic.value
  });

  if (eleecion === "Autonomo") {
    if (!dateAltaAutonomo.value || !lineActividadAutonomo.value || !lineGastosAutonomo.value || !lineIvaSuportAutonomo.value || !lineIvaRepertAutonomo.value || (!radiovehiculoTrueAutonomo.checked && !radiovehiculoFalseAutonomo.checked)) {
      mostrarToast("Faltan preguntas específicas de Autónomo por completar", "error");
      return;
    }
    datos.push({
      fechaAlta: dateAltaAutonomo.value,
      actividad: lineActividadAutonomo.value,
      gastosDeducibles: lineGastosAutonomo.value,
      ivaSoportado: lineIvaSuportAutonomo.value,
      ivaRepercutido: lineIvaRepertAutonomo.value,
      vehiculo: radiovehiculoTrueAutonomo.checked ? true : false
    });
  } else if (eleecion === "Asalariado") {
    if (!comboTipoJobAsalariado.value || (!radioFamiliaTrueAsalariado.checked && !radioFamiliaFalseAsalariado.checked) || !lineArrayEdadesAsalariado.value || !lineGastosAsalariado.value) {
      mostrarToast("Faltan preguntas específicas de Asalariado por completar", "error");
      return;
    }
    datos.push({
      tipoContrato: comboTipoJobAsalariado.value,
      familiaNumerosa: radioFamiliaTrueAsalariado.checked ? true : false,
      edadesHijos: lineArrayEdadesAsalariado.value,
      gastosEscolares: lineGastosAsalariado.value
    });
  } else if (eleecion === "Estudiante") {
    if (!comboEstudiosEstudiante.value || (!radioTrabajoTrueEstudiante.checked && !radioTrabajoFalseEstudiante.checked) || !lineBecaEstudiante.value) {
      mostrarToast("Faltan preguntas específicas de Estudiante por completar", "error");
      return;
    }
    datos.push({
      tipoEstudios: comboEstudiosEstudiante.value,
      trabaja: radioTrabajoTrueEstudiante.checked ? true : false,
      becaCantidad: lineBecaEstudiante.value
    });
  } else if (eleecion === "Jubilado") {
    if (!linePensionJubilado.value || (!radioSegundaViviendaTrueJubilado.checked && !radioSegundaViviendaFalseJubilado.checked) || !lineGastosMedicosJubilado.value) {
      mostrarToast("Faltan preguntas específicas de Jubilado por completar", "error");
      return;
    }
    datos.push({
      pensionAnual: linePensionJubilado.value,
      segundaVivienda: radioSegundaViviendaTrueJubilado.checked ? true : false,
      gastosMedicos: lineGastosMedicosJubilado.value
    });
  } else if (eleecion === "Empresario") {
    if (!comboTipoContratoEmpresario.value || !lineFacturacionEmpresario.value || !lineSueldoAdministradorEmpresario.value || !lineEmpleadosEmpresario.value || !lineGastosDeduciblesEmpresario.value) {
      mostrarToast("Faltan preguntas específicas de Empresario por completar", "error");
      return;
    }
    datos.push({
      tipoContrato: comboTipoContratoEmpresario.value,
      facturacionEmpresa: lineFacturacionEmpresario.value,
      sueldoAdministrador: lineSueldoAdministradorEmpresario.value,
      empleados: lineEmpleadosEmpresario.value,
      gastosDeduciblesEmpresa: lineGastosDeduciblesEmpresario.value
    });
  }


  if (window.transferenciaDeDatos && typeof window.transferenciaDeDatos.enviarDatos === "function") {
    window.transferenciaDeDatos.enviarDatos(datos); //--------------------------------------------------------------------------------
    mostrarToast("Formulario enviado correctamente", "success");
  } else {
    mostrarToast("No se pudo enviar los datos: función no disponible", "error");
  }

  deshabilitarCampos();



  // añadirFirebase(datos);
} function mostrarToast(mensaje, tipo) {
  const notificacion = document.createElement("div");
  notificacion.classList.add("toast");
  notificacion.classList.add(tipo === "success" ? "toast-success" : "toast-error");
  notificacion.innerHTML = mensaje;
  toasts.appendChild(notificacion);

  setTimeout(() => {
    notificacion.remove();
  }, 3000);
}


function deshabilitarCampos() {
  const campos = document.querySelectorAll("input, select");
  campos.forEach(campo => {
    campo.disabled = true;
  });
}


function reiniciarCuestionario() {

  const campos = document.querySelectorAll("input, select");
  campos.forEach(campo => {
    campo.disabled = false;
  });


  const inputs = document.querySelectorAll("input");
  inputs.forEach(input => {
    if (input.type === "radio" || input.type === "checkbox") {
      input.checked = false;
    } else {
      input.value = "";
    }
  });

  const selects = document.querySelectorAll("select");
  selects.forEach(select => {
    select.selectedIndex = 0;
  });

  mostrarToast("Cuestionario reiniciado", "success");
}






const enviar = document.querySelector('.boton');
const toasts = document.getElementById('toasts');
// Preguntas comunes
const comboSituacionBasic = document.querySelector('#encontrate')
const lineIngresoBasic = document.querySelector('#ingresoBruto');
const lineEdadBasic = document.querySelector('#edad');
const lineAcargoBasic = document.querySelector('#personasACargo');
const radioViviendaTrueBasic = document.querySelector('#viviendaSi');
const radioViviendaFalseBasic = document.querySelector('#viviendaNo');

// Preguntas Autónomo
const dateAltaAutonomo = document.querySelector('#datetime');
const lineActividadAutonomo = document.querySelector('#actividadProfesional');
const lineGastosAutonomo = document.querySelector('#gastosDeducibles');
const lineIvaSuportAutonomo = document.querySelector('#ivaSoportado');
const lineIvaRepertAutonomo = document.querySelector('#ivaRepercutido');
const radiovehiculoTrueAutonomo = document.querySelector('#vehiculoSi');
const radiovehiculoFalseAutonomo = document.querySelector('#vehiculoNo');

// Preguntas Asalariado
const comboTipoJobAsalariado = document.querySelector('#tipoContrato');
const radioFamiliaTrueAsalariado = document.querySelector('#familiaNumerosaSi');
const radioFamiliaFalseAsalariado = document.querySelector('#familiaNumerosaNo');
const lineArrayEdadesAsalariado = document.querySelector('#edadesHijos');
const lineGastosAsalariado = document.querySelector('#gastosEscolares');

// Preguntas Estudiante
const comboEstudiosEstudiante = document.querySelector('#tipoEstudios');
const radioTrabajoTrueEstudiante = document.querySelector('#trabajoSi');
const radioTrabajoFalseEstudiante = document.querySelector('#trabajoNo');
const lineBecaEstudiante = document.querySelector('#becaCantidad');

// Preguntas Jubilado
const linePensionJubilado = document.querySelector('#pensionAnual');
const radioSegundaViviendaTrueJubilado = document.querySelector('#segundaViviendaSi');
const radioSegundaViviendaFalseJubilado = document.querySelector('#segundaViviendaNo');
const lineGastosMedicosJubilado = document.querySelector('#gastosMedicos');

// Preguntas Empresario
const comboTipoContratoEmpresario = document.querySelector('#tipoContrato');
const lineFacturacionEmpresario = document.querySelector('#facturacionEmpresa');
const lineSueldoAdministradorEmpresario = document.querySelector('#sueldoAdministrador');
const lineEmpleadosEmpresario = document.querySelector('#empleados');
const lineGastosDeduciblesEmpresario = document.querySelector('#gastosDeduciblesEmpresa');
    </script>
</body>
</html>